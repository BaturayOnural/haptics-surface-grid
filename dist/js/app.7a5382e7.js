(function(){"use strict";var e={1223:function(e,t,a){var i=a(5130),r=a(6768);const o={id:"app"};function s(e,t,a,i,s,n){const l=(0,r.g2)("router-view");return(0,r.uX)(),(0,r.CE)("div",o,[(0,r.bF)(l)])}var n={name:"App"},l=a(1241);const d=(0,l.A)(n,[["render",s],["__scopeId","data-v-67de6e6a"]]);var c=d,u=a(1387),h=a(4232);const p={class:"video-upload"},m={class:"upload-section"},g={class:"custom-file-input"},f={key:0,class:"processing-message"},v={key:1,class:"error"};function k(e,t,a,i,o,s){return(0,r.uX)(),(0,r.CE)("div",p,[t[4]||(t[4]=(0,r.Lk)("h1",{class:"project-title"},"📹 Synchronous Haptics Grid Mapping from Top-down Videos of Water Surface",-1)),t[5]||(t[5]=(0,r.Lk)("p",{class:"project-description"}," This project presents a method for analyzing the motion of water waves in video footage to simulate the tactile sensations one would experience by haptic expressions on their hand. The primary goal is to track the progression of a wave and continuously calculate its intensity. ",-1)),t[6]||(t[6]=(0,r.Lk)("a",{href:"https://github.com/BaturayOnural/haptics-surface-grid",target:"_blank",class:"github-link"},[(0,r.Lk)("img",{src:"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png",alt:"GitHub Logo",class:"github-logo"}),(0,r.eW)(" View Project on GitHub ")],-1)),(0,r.Lk)("div",m,[t[3]||(t[3]=(0,r.Lk)("h2",null,"Upload Water Wave Video",-1)),(0,r.Lk)("div",g,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.triggerFileSelect&&s.triggerFileSelect(...e)),class:"upload-btn"},"Select Video"),(0,r.Lk)("input",{type:"file",ref:"fileInput",onChange:t[1]||(t[1]=(...e)=>s.handleFileUpload&&s.handleFileUpload(...e)),accept:"video/*",style:{display:"none"}},null,544)]),o.isProcessing?((0,r.uX)(),(0,r.CE)("div",f,t[2]||(t[2]=[(0,r.Lk)("p",null,"⏳ Processing...",-1)]))):(0,r.Q3)("",!0),o.errorMessage?((0,r.uX)(),(0,r.CE)("p",v,(0,h.v_)(o.errorMessage),1)):(0,r.Q3)("",!0)])])}a(4114),a(4603),a(7566),a(8721);var b=a(4373),F={data(){return{errorMessage:"",isProcessing:!1}},methods:{triggerFileSelect(){this.$refs.fileInput.click()},handleFileUpload(e){const t=e.target.files[0];if(t){if(t.size>104857600)return void(this.errorMessage="File size exceeds 100MB. Please select a smaller file.");const e=document.createElement("video");e.preload="metadata",e.src=URL.createObjectURL(t),e.onloadedmetadata=()=>{if(e.duration>30)this.errorMessage="Video duration exceeds 30 seconds. Please select a shorter video.";else{this.errorMessage="",this.isProcessing=!0;const e=new FormData;e.append("video",t),b.A.post("/api/upload",e).then((e=>{const{video_filename:t,data_filename:a}=e.data;this.$store.commit("setVideoFilename",t),this.$store.commit("setDataFilename",a),this.isProcessing=!1,this.$router.push("/playback")})).catch((e=>{this.errorMessage="An error occurred while uploading the video. Please try again.",console.error(e),this.isProcessing=!1}))}},e.onerror=()=>{this.errorMessage="Invalid video file. Please select a valid video."}}}}};const y=(0,l.A)(F,[["render",k],["__scopeId","data-v-29c89d3b"]]);var w=y;const C={class:"video-playback"},L={class:"content-container"},x={class:"main-content"},_={class:"frame-container"},T={class:"frame-info"},I={class:"frame-title"},S={class:"time-display"},P={ref:"canvas",class:"frame-image"},D=["disabled"],O={class:"grid-container"},M=["disabled"],E={class:"legend"},V={ref:"legendCanvas",class:"legend-bar"};function j(e,t,a,i,o,s){return(0,r.uX)(),(0,r.CE)("div",C,[t[4]||(t[4]=(0,r.Lk)("h1",{class:"page-title"},"🎥 Video Analysis",-1)),(0,r.Lk)("div",L,[(0,r.Lk)("div",x,[(0,r.Lk)("div",_,[(0,r.Lk)("div",T,[(0,r.Lk)("div",I,"Frame ("+(0,h.v_)(o.frameIndex+1)+"/"+(0,h.v_)(o.totalFrames)+")",1),(0,r.Lk)("div",S,"Time: "+(0,h.v_)(o.currentTimestamp)+" ms",1)]),(0,r.Lk)("canvas",P,null,512),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.previousFrame&&s.previousFrame(...e)),disabled:0===o.frameIndex,class:"nav-button"},"Previous Frame",8,D)]),(0,r.Lk)("div",O,[t[2]||(t[2]=(0,r.Lk)("div",{class:"grid-title"},"Wave Intensity Grid",-1)),(0,r.Lk)("div",{class:"grid",style:(0,h.Tr)({gridTemplateColumns:"repeat("+o.gridCols+", 1fr)",gridTemplateRows:"repeat("+o.gridRows+", 1fr)"})},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.currentGridData,((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,style:(0,h.Tr)({backgroundColor:s.getInterpolatedColor(e)}),class:"grid-cell"},null,4)))),128))],4),(0,r.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>s.nextFrame&&s.nextFrame(...e)),disabled:o.frameIndex>=o.totalFrames-1,class:"nav-button"},"Next Frame",8,M)])]),(0,r.Lk)("div",E,[t[3]||(t[3]=(0,r.Lk)("h4",null,"Intensity Legend",-1)),(0,r.Lk)("canvas",V,null,512)])])])}a(1454);var R=a(782),$={computed:{...(0,R.L8)(["getVideoFilename","getDataFilename"])},data(){return{frameIndex:0,framesData:[],currentGridData:[],currentTimestamp:0,video:null,isVideoLoaded:!1,gridRows:0,gridCols:0,totalFrames:0}},methods:{fetchData(){const e=this.getVideoFilename,t=this.getDataFilename,a=`/api/video/${e}`;this.video=document.createElement("video"),this.video.src=a,this.video.onloadeddata=()=>{this.isVideoLoaded=!0,this.captureFrame()},b.A.get(`/api/data/${t}`).then((e=>{const t=e.data;this.framesData=t.intensity_matrices,this.gridRows=t.grid_rows,this.gridCols=t.grid_cols,this.totalFrames=this.framesData.length,this.updateFrame(0),this.drawLegend()})).catch((e=>{console.error("Error fetching intensity data:",e)}))},updateFrame(e){this.frameIndex=e,this.currentGridData=this.framesData[e].intensity_grid.flat(),this.currentTimestamp=this.framesData[e].timestamp_ms,this.captureFrame()},getInterpolatedColor(e){return e<=.2?this.interpolateColor([0,0,139],[0,0,255],e/.2):e<=.4?this.interpolateColor([0,0,255],[0,255,255],(e-.2)/.2):e<=.6?this.interpolateColor([0,255,255],[255,255,0],(e-.4)/.2):e<=.8?this.interpolateColor([255,255,0],[255,165,0],(e-.6)/.2):this.interpolateColor([255,165,0],[139,0,0],(e-.8)/.2)},interpolateColor(e,t,a){const i=e.map(((e,i)=>Math.round(e+a*(t[i]-e))));return`rgb(${i[0]}, ${i[1]}, ${i[2]})`},captureFrame(){if(this.isVideoLoaded){const e=this.$refs.canvas,t=e.getContext("2d");e.width=640,e.height=360;const a=300,i=this.frameIndex*a/1e3;this.video.currentTime=i,this.video.onseeked=()=>{t.drawImage(this.video,0,0,e.width,e.height),this.drawGridLines(t,e.width,e.height)}}},drawGridLines(e,t,a){e.strokeStyle="white",e.lineWidth=1;for(let i=1;i<this.gridCols;i++)e.beginPath(),e.moveTo(i*t/this.gridCols,0),e.lineTo(i*t/this.gridCols,a),e.stroke();for(let i=1;i<this.gridRows;i++)e.beginPath(),e.moveTo(0,i*a/this.gridRows),e.lineTo(t,i*a/this.gridRows),e.stroke()},drawLegend(){const e=this.$refs.legendCanvas,t=e.getContext("2d"),a=window.devicePixelRatio||1,i=300,r=60;e.width=i*a,e.height=r*a,t.scale(a,a);const o=260,s=20;t.clearRect(0,0,i,r);const n=t.createLinearGradient(s,0,s+o,0);n.addColorStop(0,"DarkBlue"),n.addColorStop(.2,"Blue"),n.addColorStop(.4,"Cyan"),n.addColorStop(.6,"Yellow"),n.addColorStop(.8,"Orange"),n.addColorStop(1,"DarkRed"),t.fillStyle=n,t.fillRect(s,20,o,20);const l=[0,.2,.4,.6,.8,1];l.forEach(((e,a)=>{const i=s+a*(o/(l.length-1));t.strokeStyle="black",t.lineWidth=1,t.beginPath(),t.moveTo(i,40),t.lineTo(i,50),t.stroke(),t.fillStyle="black",t.font="12px Arial",t.textAlign="center",t.textBaseline="top",t.fillText(e.toFixed(1),i,52)}))},previousFrame(){this.frameIndex>0&&this.updateFrame(this.frameIndex-1)},nextFrame(){this.frameIndex<this.totalFrames-1&&this.updateFrame(this.frameIndex+1)}},mounted(){this.fetchData()}};const A=(0,l.A)($,[["render",j],["__scopeId","data-v-1e490f61"]]);var G=A;const W=[{path:"/",component:w},{path:"/playback",component:G}],X=(0,u.aE)({history:(0,u.LA)(),routes:W});var U=X;const B=(0,R.y$)({state:{videoFilename:"",dataFilename:""},mutations:{setVideoFilename(e,t){e.videoFilename=t},setDataFilename(e,t){e.dataFilename=t}},actions:{},getters:{getVideoFilename:e=>e.videoFilename,getDataFilename:e=>e.dataFilename}});var H=B;const z=(0,i.Ef)(c);z.use(H),z.use(U),z.mount("#app")}},t={};function a(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,i,r,o){if(!i){var s=1/0;for(c=0;c<e.length;c++){i=e[c][0],r=e[c][1],o=e[c][2];for(var n=!0,l=0;l<i.length;l++)(!1&o||s>=o)&&Object.keys(a.O).every((function(e){return a.O[e](i[l])}))?i.splice(l--,1):(n=!1,o<s&&(s=o));if(n){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[i,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var r,o,s=i[0],n=i[1],l=i[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(r in n)a.o(n,r)&&(a.m[r]=n[r]);if(l)var c=l(a)}for(t&&t(i);d<s.length;d++)o=s[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},i=self["webpackChunkwave_haptic_app"]=self["webpackChunkwave_haptic_app"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(1223)}));i=a.O(i)})();
//# sourceMappingURL=app.7a5382e7.js.map